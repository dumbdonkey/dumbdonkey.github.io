<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.0.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.0" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="TBD">
<meta name="keywords" content="ç å†œ è“æ˜Ÿ">
<meta property="og:type" content="website">
<meta property="og:title" content="è“æ˜Ÿç å†œç”Ÿå­˜æ—¥å¿—">
<meta property="og:url" content="https://dumbdonkey.github.io/about/index.html">
<meta property="og:site_name" content="è“æ˜Ÿç å†œç”Ÿå­˜æ—¥å¿—">
<meta property="og:description" content="TBD">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-09-08T04:42:26.601Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è“æ˜Ÿç å†œç”Ÿå­˜æ—¥å¿—">
<meta name="twitter:description" content="TBD">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.0.0',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://dumbdonkey.github.io/about/">





  <title>è®¡ç®—æœºåŸºç¡€ | è“æ˜Ÿç å†œç”Ÿå­˜æ—¥å¿—</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">è“æ˜Ÿç å†œç”Ÿå­˜æ—¥å¿—</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>
            
            å…¬ç›Š404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            æœç´¢
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="æœç´¢..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dumbdonkey.github.io/2019/09/10/è®¡ç®—æœºåŸºç¡€/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="dumbdonkey">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è“æ˜Ÿç å†œç”Ÿå­˜æ—¥å¿—">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">è®¡ç®—æœºåŸºç¡€</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-09-10T11:09:59+08:00">2019-09-10</time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/è®¡ç®—æœºåŸºç¡€/" itemprop="url" rel="index">
                    <span itemprop="name">è®¡ç®—æœºåŸºç¡€</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/09/10/è®¡ç®—æœºåŸºç¡€/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/09/10/è®¡ç®—æœºåŸºç¡€/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <ul>
<li><p>ä¸€ä¸ªæœ‰å…³å†…æ ¸å¼€å‘çš„wiki,é‡Œé¢æœ‰å¾ˆå¤šä¸é”™çš„çŸ¥è¯†</p>
<p>  <a href="https://wiki.osdev.org/Main_Page" target="_blank" rel="noopener">https://wiki.osdev.org/Main_Page</a></p>
</li>
</ul>
<ul>
<li><p>ä¸€äº›intelçš„å¤è€æ–‡æ¡£</p>
<p>  <a href="http://www.nj7p.org/Manuals/Intel_Manuals1.php" target="_blank" rel="noopener">http://www.nj7p.org/Manuals/Intel_Manuals1.php</a></p>
</li>
</ul>
<h2 id="å®æ¨¡å¼ä¸ä¿æŠ¤æ¨¡å¼"><a href="#å®æ¨¡å¼ä¸ä¿æŠ¤æ¨¡å¼" class="headerlink" title="å®æ¨¡å¼ä¸ä¿æŠ¤æ¨¡å¼"></a>å®æ¨¡å¼ä¸ä¿æŠ¤æ¨¡å¼</h2><p>refer:<a href="https://www.geek.com/chips/difference-between-real-mode-and-protected-mode-574665/" target="_blank" rel="noopener">https://www.geek.com/chips/difference-between-real-mode-and-protected-mode-574665/</a></p>
<h3 id="ä¸ºä»€ä¹ˆéœ€è¦åˆ’åˆ†å®æ¨¡å¼ä¸ä¿æŠ¤æ¨¡å¼"><a href="#ä¸ºä»€ä¹ˆéœ€è¦åˆ’åˆ†å®æ¨¡å¼ä¸ä¿æŠ¤æ¨¡å¼" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦åˆ’åˆ†å®æ¨¡å¼ä¸ä¿æŠ¤æ¨¡å¼?"></a>ä¸ºä»€ä¹ˆéœ€è¦åˆ’åˆ†å®æ¨¡å¼ä¸ä¿æŠ¤æ¨¡å¼?</h3><p>Prior to protected mode, multiple programs could be running in memory at the same time, but any program could access any area of memory and, therefore, if malicious or errant, for example, could take down the entire system.</p>
<h3 id="concepts"><a href="#concepts" class="headerlink" title="concepts"></a>concepts</h3><ul>
<li><p>Real Mode</p>
<p>  å®æ¨¡å¼ä¸‹ç¨‹åºå¯ä»¥è®¿é—®æ‰€æœ‰çš„å†…å­˜ç©ºé—´ã€‚ å¦‚æœä¸€ä¸ªç¨‹åºè®¿é—®äº†å®ƒä¸è¯¥è®¿é—®çš„åœ°æ–¹å°±å¯èƒ½é€ æˆå…¶ä»–ç¨‹åºçš„å¼‚å¸¸æˆ–ç³»ç»Ÿå¥”æºƒ</p>
</li>
<li><p>Protect Mode</p>
<p>  ä¿æŠ¤æ¨¡å¼,åœ¨ç¡¬ä»¶çº§åˆ«é™åˆ¶å¯è®¿é—®çš„å†…å­˜åŒºåŸŸ<br>  é€šè¿‡å†…å­˜åˆ†é¡µæœºåˆ¶å…è®¸æ¯ä¸ªè¿›ç¨‹éƒ½å¯ä»¥è®¿é—®æœ€å¤§çš„å†…å­˜åŒºåŸŸã€‚<br>  æ•°æ®åªæœ‰åœ¨çœŸæ­£éœ€è¦çš„æ—¶å€™æ‰è¢«æ¢å…¥å†…å­˜. å†…å­˜ä¸è¶³çš„æ—¶å€™,ä¼šç”¨swap file é¡¶æ›¿</p>
</li>
</ul>
<h2 id="è®¡ç®—æœºå¯åŠ¨è¿‡ç¨‹"><a href="#è®¡ç®—æœºå¯åŠ¨è¿‡ç¨‹" class="headerlink" title="è®¡ç®—æœºå¯åŠ¨è¿‡ç¨‹"></a>è®¡ç®—æœºå¯åŠ¨è¿‡ç¨‹</h2><ol>
<li><p>æŒ‰ä¸‹ç”µæºæŒ‰é’®</p>
</li>
<li><p>CPUä»æŒ‡å®šä½ç½®å¼€å§‹è¯»å–æŒ‡ä»¤ï¼Œé€ä¸€æ‰§è¡Œ</p>
</li>
<li><p>BIOSåˆå§‹åŒ–</p>
</li>
<li><p>ç¡¬ä»¶æ£€æŸ¥&amp;å¯»æ‰¾å¯å¼•å¯¼è®¾å¤‡</p>
</li>
</ol>
<h2 id="å†…æ ¸"><a href="#å†…æ ¸" class="headerlink" title="å†…æ ¸"></a>å†…æ ¸</h2><p>Linux å†…æ ¸çš„ä¸»è¦ç”¨é€”å°±æ˜¯ä¸ºäº†ä¸è®¡ç®—æœºç¡¬ä»¶è¿›è¡Œäº¤äº’ï¼Œå®ç°å¯¹ç¡¬ä»¶éƒ¨ä»¶çš„ç¼–ç¨‹æ§åˆ¶å’Œæ¥å£æ“ä½œï¼Œ<br>è°ƒåº¦å¯¹ç¡¬ä»¶èµ„æºçš„è®¿é—®ï¼Œå¹¶ä¸ºè®¡ç®—æœºä¸Šçš„ç”¨æˆ·ç¨‹åºæä¾›ä¸€ä¸ªé«˜çº§çš„æ‰§è¡Œç¯å¢ƒå’Œå¯¹ç¡¬ä»¶çš„è™šæ‹Ÿæ¥å£ã€‚</p>
<h2 id="å†…æ ¸ä½“ç³»"><a href="#å†…æ ¸ä½“ç³»" class="headerlink" title="å†…æ ¸ä½“ç³»"></a>å†…æ ¸ä½“ç³»</h2><p><img src="./resource/2019-09-11-14-22-12.png" alt></p>
<p><img src="./resource/2019-09-11-14-23-40.png" alt></p>
<h3 id="è¿›ç¨‹è°ƒåº¦æ¨¡å—"><a href="#è¿›ç¨‹è°ƒåº¦æ¨¡å—" class="headerlink" title="è¿›ç¨‹è°ƒåº¦æ¨¡å—"></a>è¿›ç¨‹è°ƒåº¦æ¨¡å—</h3><p>è¿›ç¨‹è°ƒåº¦æ¨¡å—ç”¨æ¥è´Ÿè´£æ§åˆ¶è¿›ç¨‹å¯¹CPU èµ„æºçš„ä½¿ç”¨ã€‚æ‰€é‡‡å–çš„è°ƒåº¦ç­–ç•¥æ˜¯å„è¿›ç¨‹èƒ½å¤Ÿå…¬å¹³åˆç†åœ°è®¿é—®CPUï¼ŒåŒæ—¶ä¿è¯å†…æ ¸èƒ½åŠæ—¶åœ°æ‰§è¡Œç¡¬ä»¶æ“ä½œã€‚</p>
<h3 id="å†…å­˜ç®¡ç†æ¨¡å—"><a href="#å†…å­˜ç®¡ç†æ¨¡å—" class="headerlink" title="å†…å­˜ç®¡ç†æ¨¡å—"></a>å†…å­˜ç®¡ç†æ¨¡å—</h3><p>å†…å­˜ç®¡ç†æ¨¡å—ç”¨äºç¡®ä¿æ‰€æœ‰è¿›ç¨‹èƒ½å¤Ÿå®‰å…¨åœ°å…±äº«æœºå™¨ä¸»å†…å­˜åŒºï¼ŒåŒæ—¶ï¼Œå†…å­˜ç®¡ç†æ¨¡å—è¿˜æ”¯æŒè™šæ‹Ÿå†…å­˜ç®¡ç†æ–¹å¼ï¼Œä½¿å¾—Linux æ”¯æŒè¿›ç¨‹ä½¿ç”¨æ¯”å®é™…å†…å­˜ç©ºé—´æ›´å¤šçš„å†…å­˜å®¹é‡ã€‚å¹¶å¯ä»¥åˆ©ç”¨æ–‡ä»¶ç³»ç»ŸæŠŠæš‚æ—¶ä¸ç”¨çš„å†…å­˜æ•°æ®å—ä¼šè¢«äº¤æ¢åˆ°å¤–éƒ¨å­˜å‚¨è®¾å¤‡ä¸Šå»ï¼Œå½“éœ€è¦æ—¶å†äº¤æ¢å›æ¥ã€‚</p>
<h3 id="æ–‡ä»¶ç³»ç»Ÿæ¨¡å—"><a href="#æ–‡ä»¶ç³»ç»Ÿæ¨¡å—" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿæ¨¡å—"></a>æ–‡ä»¶ç³»ç»Ÿæ¨¡å—</h3><p>æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ç”¨äºæ”¯æŒå¯¹å¤–éƒ¨è®¾å¤‡çš„é©±åŠ¨å’Œå­˜å‚¨ã€‚è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ¨¡å—é€šè¿‡å‘æ‰€æœ‰çš„å¤–éƒ¨å­˜å‚¨è®¾å¤‡æä¾›ä¸€ä¸ªé€šç”¨çš„æ–‡ä»¶æ¥å£ï¼Œéšè—äº†å„ç§ç¡¬ä»¶è®¾å¤‡çš„ä¸åŒç»†èŠ‚ã€‚ä»è€Œæä¾›å¹¶æ”¯æŒä¸å…¶å®ƒæ“ä½œç³»ç»Ÿå…¼å®¹çš„å¤šç§æ–‡ä»¶ç³»ç»Ÿæ ¼å¼ã€‚</p>
<h3 id="è¿›ç¨‹é—´é€šä¿¡æ¨¡å—"><a href="#è¿›ç¨‹é—´é€šä¿¡æ¨¡å—" class="headerlink" title="è¿›ç¨‹é—´é€šä¿¡æ¨¡å—"></a>è¿›ç¨‹é—´é€šä¿¡æ¨¡å—</h3><p>è¿›ç¨‹é—´é€šä¿¡æ¨¡å—å­ç³»ç»Ÿç”¨äºæ”¯æŒå¤šç§è¿›ç¨‹é—´çš„ä¿¡æ¯äº¤æ¢æ–¹å¼ã€‚</p>
<h3 id="ç½‘ç»œæ¥å£æ¨¡å—"><a href="#ç½‘ç»œæ¥å£æ¨¡å—" class="headerlink" title="ç½‘ç»œæ¥å£æ¨¡å—"></a>ç½‘ç»œæ¥å£æ¨¡å—</h3><p>ç½‘ç»œæ¥å£æ¨¡å—æä¾›å¯¹å¤šç§ç½‘ç»œé€šä¿¡æ ‡å‡†çš„è®¿é—®å¹¶æ”¯æŒè®¸å¤šç½‘ç»œç¡¬ä»¶ã€‚</p>
<h2 id="ç³»ç»Ÿå®šæ—¶"><a href="#ç³»ç»Ÿå®šæ—¶" class="headerlink" title="ç³»ç»Ÿå®šæ—¶"></a>ç³»ç»Ÿå®šæ—¶</h2><p>æ—¶é’Ÿä¸­æ–­å¤„ç†æ—¶æ›´æ–°jiffieså˜é‡ï¼Œåˆ¤æ–­æ—¶é—´ç‰‡æ˜¯å¦ç”¨å®Œï¼Œæ˜¯å¦éœ€è¦è¿›è¡Œè°ƒåº¦</p>
<h2 id="è¿›ç¨‹æ¨¡å—"><a href="#è¿›ç¨‹æ¨¡å—" class="headerlink" title="è¿›ç¨‹æ¨¡å—"></a>è¿›ç¨‹æ¨¡å—</h2><p><img src="./resource/2019-09-11-14-38-54.png" alt></p>
<p><a href="https://eklitzke.org/uninterruptible-sleep" target="_blank" rel="noopener">https://eklitzke.org/uninterruptible-sleep</a></p>
<ul>
<li><p>TASK_INTERRUPTIBLE</p>
<p> A process which is placed in the TASK_INTERRUPTIBLE state will sleep until either (1) something explicitly wakes it up, or (2) a non-masked signal is received</p>
<p> eg:</p>
<p> æ‰§è¡Œsleep(30) å‘½ä»¤çš„è¿›ç¨‹å°±ä¼šå¤„äºinterruptible sleep çŠ¶æ€</p>
<p> strace æ¼”ç¤º</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ2ze0fgielr9er134vdz0Z ~]# strace -f -p 2014</span><br><span class="line">strace: Process 2014 attached</span><br><span class="line">restart_syscall(&lt;... resuming interrupted nanosleep ...&gt;) = ? ERESTART_RESTARTBLOCK (Interrupted by signal)</span><br><span class="line">--- SIGTERM &#123;si_signo=SIGTERM, si_code=SI_USER, si_pid=4177, si_uid=0&#125; ---</span><br><span class="line">+++ killed by SIGTERM +++</span><br></pre></td></tr></table></figure>
</li>
<li><p>TASK_UNINTERRUPTIBLE</p>
<p>  The TASK_UNINTERRUPTIBLE state, instead, ignores signals; processes in that state will require an explicit wakeup before they can run again.</p>
</li>
</ul>
<p>è¿›ç¨‹çš„æŠ¢å å‘ç”Ÿåœ¨è¿›ç¨‹å¤„äºç”¨æˆ·æ€æ‰§è¡Œé˜¶æ®µï¼Œåœ¨å†…æ ¸æ€æ‰§è¡Œæ—¶æ˜¯ä¸èƒ½è¢«æŠ¢å çš„ã€‚</p>
<p>read,writeæ“ä½œä¼šsleepå•Šï¼Œæ­¤æ—¶è¿˜æ˜¯ä¼šè¢«æŠ¢å å•Š</p>
<ul>
<li><p>å­¤å„¿è¿›ç¨‹</p>
<p>  ä¸€ä¸ªçˆ¶è¿›ç¨‹é€€å‡ºï¼Œè€Œå®ƒçš„ä¸€ä¸ªæˆ–å¤šä¸ªå­è¿›ç¨‹è¿˜åœ¨è¿è¡Œï¼Œé‚£ä¹ˆé‚£äº›å­è¿›ç¨‹å°†æˆä¸ºå­¤å„¿è¿›ç¨‹ã€‚å­¤å„¿è¿›ç¨‹å°†è¢«initè¿›ç¨‹(è¿›ç¨‹å·ä¸º1)æ‰€æ”¶å…»ï¼Œå¹¶ç”±initè¿›ç¨‹å¯¹å®ƒä»¬å®ŒæˆçŠ¶æ€æ”¶é›†å·¥ä½œ</p>
</li>
<li><p>åƒµå°¸è¿›ç¨‹</p>
<p>  ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨forkåˆ›å»ºå­è¿›ç¨‹ï¼Œå¦‚æœå­è¿›ç¨‹é€€å‡ºï¼Œè€Œçˆ¶è¿›ç¨‹å¹¶æ²¡æœ‰è°ƒç”¨waitæˆ–waitpidè·å–å­è¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯ï¼Œé‚£ä¹ˆå­è¿›ç¨‹çš„è¿›ç¨‹æè¿°ç¬¦ä»ç„¶ä¿å­˜åœ¨ç³»ç»Ÿä¸­ã€‚è¿™ç§è¿›ç¨‹ç§°ä¹‹ä¸ºåƒµæ­»è¿›ç¨‹ã€‚</p>
<p>  è§£å†³:<br>  kill çˆ¶è¿›ç¨‹<br>  ç„¶åå­è¿›ç¨‹ä¼šæ‰˜ç®¡ç»™initè¿›ç¨‹è¿›è¡Œå›æ”¶</p>
</li>
</ul>
<h3 id="ä»»åŠ¡çš„å †æ ˆ"><a href="#ä»»åŠ¡çš„å †æ ˆ" class="headerlink" title="ä»»åŠ¡çš„å †æ ˆ"></a>ä»»åŠ¡çš„å †æ ˆ</h3><p>æ¯ä¸ªä»»åŠ¡éƒ½æœ‰ä¸¤ä¸ªå †æ ˆï¼Œåˆ†åˆ«ç”¨äºç”¨æˆ·æ€å’Œå†…æ ¸æ€ç¨‹åºçš„æ‰§è¡Œï¼Œå¹¶ä¸”åˆ†åˆ«ç§°ä¸ºç”¨æˆ·æ€å †æ ˆå’Œå†…æ ¸æ€<br>å †æ ˆã€‚è¿™ä¸¤ä¸ªå †æ ˆä¹‹é—´çš„ä¸»è¦åŒºåˆ«åœ¨äºä»»åŠ¡çš„å†…æ ¸æ€å †æ ˆå¾ˆå°ï¼Œ</p>
<h3 id="CPU-load"><a href="#CPU-load" class="headerlink" title="CPU load"></a>CPU load</h3><p><a href="https://www.kernel.org/doc/html/latest/admin-guide/cpu-load.html" target="_blank" rel="noopener">https://www.kernel.org/doc/html/latest/admin-guide/cpu-load.html</a></p>
<p>loadçš„ä¸å¯é </p>
<p>linuxçš„load=runnable + uninterruptible sleep( It is mostly used by device drivers waiting for disk or network IO (input/output). )</p>
<p>é—®é¢˜:</p>
<ol>
<li><p>æ¨¡æ‹Ÿå‡ºä¸€ä¸ªuninterruptible sleepçŠ¶æ€æ¥?</p>
<p> socketæ…¢é€Ÿå†™æ²¡ç”¨</p>
</li>
</ol>
<h2 id="å†…å­˜æ¨¡å—"><a href="#å†…å­˜æ¨¡å—" class="headerlink" title="å†…å­˜æ¨¡å—"></a>å†…å­˜æ¨¡å—</h2><p>ä½¿ç”¨è™šæ‹Ÿå†…å­˜å‘æ¯ä¸ªè¿›ç¨‹æä¾›è¶³å¤Ÿå¤§çš„å¯å¯»å€ç©ºé—´ã€‚</p>
<p>é€šè¿‡ç¼ºé¡µä¸­æ–­å®Œæˆæ•°æ®çš„è¯»å–ã€‚ </p>
<p>ç¼ºé¡µä¸­æ–­å¤„ç†è¿‡ç¨‹å¯èƒ½ä¼šæ¶‰åŠpage swapping</p>
<p>æ³¨æ„:</p>
<p>æˆ‘ä»¬ç”³è¯·ä¸€å¤§å—è¿ç»­å†…å­˜ï¼Œåœ¨ç‰©ç†å†…å­˜ä¸Šä¸ä¸€å®šæ˜¯è¿ç»­çš„ï¼Œåªæ˜¯åœ¨è™šæ‹Ÿå†…å­˜åœ°å€ä¸Šæ˜¯è¿ç»­çš„è€Œå·².</p>
<p>çœŸå®çš„ç‰©ç†åœ°å€æ˜¯è¦é€šè¿‡é¡µè¡¨è¿›è¡Œæ¢ç®—çš„ã€‚</p>
<h3 id="HugePage"><a href="#HugePage" class="headerlink" title="HugePage"></a>HugePage</h3><h2 id="BIOS"><a href="#BIOS" class="headerlink" title="BIOS"></a>BIOS</h2><p>BIOS (Basic Input/Output System) was created to offer generalized low-level services to early PC system programmers. The basic aims were: to hide (as much as possible) variations in PC models and hardware from the OS and applications, and to make OS and application development easier (because the BIOS services handled most of the hardware level interface).</p>
<p>These BIOS services are still used (especially during bootup), and are often named â€œBIOS functionsâ€. In Real Mode, they can be easily accessed through software interrupts, using Assembly language.</p>
<h2 id="ä¸­æ–­"><a href="#ä¸­æ–­" class="headerlink" title="ä¸­æ–­"></a>ä¸­æ–­</h2><p>è¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹ä¸­æ–­ã€‚ä¸­æ–­æ˜¯ç”±ç¡¬ä»¶æˆ–è€…è½¯ä»¶äº§ç”Ÿçš„ï¼Œå½“ä¸­æ–­äº§ç”Ÿçš„æ—¶å€™ï¼Œ CPU å°†å¾—åˆ°é€šçŸ¥ã€‚è¿™ä¸ªæ—¶å€™ï¼Œ CPU å°†åœæ­¢å½“å‰æŒ‡ä»¤çš„æ‰§è¡Œï¼Œä¿å­˜å½“å‰ä»£ç çš„ç¯å¢ƒï¼Œç„¶åå°†æ§åˆ¶æƒç§»äº¤åˆ°ä¸­æ–­å¤„ç†ç¨‹åºã€‚å½“ä¸­æ–­å¤„ç†ç¨‹åºå®Œæˆä¹‹åï¼Œå°†æ¢å¤ä¸­æ–­ä¹‹å‰çš„è¿è¡Œç¯å¢ƒï¼Œä»è€Œè¢«ä¸­æ–­çš„ä»£ç å°†ç»§ç»­æ‰§è¡Œ</p>
<ul>
<li><p>ç¡¬ä¸­æ–­</p>
<p>  Hardware interrupts are generated by hardware devices (network cards, keyboard controller, external timer, hardware senors, â€¦) when they need to signal something to the CPU (data has arrived for example).<br>  Since these can happen very frequently, and since they essentially block the current CPU while they are running, kernel hardware interrupt handlers are written to be as fast and simple as possible.</p>
</li>
<li><p>è½¯ä¸­æ–­</p>
<p>  æ¯”å¦‚ç³»ç»Ÿè°ƒç”¨</p>
<p>  If long or complex processing needs to be done, these tasks are deferred using a mechanism call softirqs. These are scheduled independently, can run on any CPU, can even run concurrently (non of that is true of hardware interrupt handlers).</p>
</li>
</ul>
<h3 id="ç³»ç»Ÿè°ƒç”¨"><a href="#ç³»ç»Ÿè°ƒç”¨" class="headerlink" title="ç³»ç»Ÿè°ƒç”¨"></a>ç³»ç»Ÿè°ƒç”¨</h3><p><img src="./resource/2019-09-12-15-38-20.png" alt></p>
<ul>
<li>man syscalls æŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨åˆ—è¡¨</li>
</ul>
<h3 id="ä¿¡å·"><a href="#ä¿¡å·" class="headerlink" title="ä¿¡å·"></a>ä¿¡å·</h3><p>åœ¨UNIX ç³»ç»Ÿä¸­ï¼Œä¿¡å·æ˜¯ä¸€ç§â€œè½¯ä»¶ä¸­æ–­â€å¤„ç†æœºåˆ¶ã€‚æœ‰è®¸å¤šè¾ƒä¸ºå¤æ‚çš„ç¨‹åºä¼šä½¿ç”¨åˆ°ä¿¡å·</p>
<p>å¯ä»¥å†™ä¸€äº›ä¿¡å·å¤„ç†å‡½æ•°æ¥å“åº”ctrl+cç­‰æ“ä½œã€‚</p>
<h2 id="ç¡¬ç›˜"><a href="#ç¡¬ç›˜" class="headerlink" title="ç¡¬ç›˜"></a>ç¡¬ç›˜</h2><p>å½“ç¨‹åºéœ€è¦è¯»å–ç¡¬ç›˜ä¸Šçš„ä¸€ä¸ªé€»è¾‘å—æ—¶ï¼Œå°±ä¼šå‘ç¼“å†²åŒºç®¡ç†ç¨‹åºæå‡ºç”³è¯·ï¼Œè€Œç¨‹åºçš„è¿›ç¨‹åˆ™è¿›å…¥ç¡<br>çœ ç­‰å¾…çŠ¶æ€ã€‚ç¼“å†²åŒºç®¡ç†ç¨‹åºé¦–å…ˆåœ¨ç¼“å†²åŒºä¸­å¯»æ‰¾ä»¥å‰æ˜¯å¦å·²ç»è¯»å–è¿‡è¿™å—æ•°æ®ã€‚å¦‚æœç¼“å†²åŒºä¸­å·²ç»æœ‰<br>äº†ï¼Œå°±ç›´æ¥å°†å¯¹åº”çš„ç¼“å†²åŒºå—å¤´æŒ‡é’ˆè¿”å›ç»™ç¨‹åºå¹¶å”¤é†’è¯¥ç¨‹åºè¿›ç¨‹ã€‚è‹¥ç¼“å†²åŒºä¸­ä¸å­˜åœ¨æ‰€è¦æ±‚çš„æ•°æ®å—ï¼Œ<br>åˆ™ç¼“å†²ç®¡ç†ç¨‹åºå°±ä¼šè°ƒç”¨æœ¬ç« ä¸­çš„ä½çº§å—è¯»å†™å‡½æ•°ll_rw_block()ï¼Œå‘ç›¸åº”çš„å—è®¾å¤‡é©±åŠ¨ç¨‹åºå‘å‡ºä¸€ä¸ªè¯»<br>æ•°æ®å—çš„æ“ä½œè¯·æ±‚ã€‚è¯¥å‡½æ•°å°±ä¼šä¸ºæ­¤åˆ›å»ºä¸€ä¸ªè¯·æ±‚ç»“æ„é¡¹ï¼Œå¹¶æ’å…¥è¯·æ±‚é˜Ÿåˆ—ä¸­ã€‚ä¸ºäº†æä¾›è¯»å†™ç£ç›˜çš„æ•ˆ<br>ç‡ï¼Œå‡å°ç£å¤´ç§»åŠ¨çš„è·ç¦»ï¼Œåœ¨æ’å…¥è¯·æ±‚é¡¹æ—¶ä½¿ç”¨äº†ç”µæ¢¯ç§»åŠ¨ç®—æ³•ã€‚</p>
<p>è¯»å†™éƒ½æ˜¯æœ‰é˜Ÿåˆ—çš„</p>
<p>å½“å¯¹åº”çš„å—è®¾å¤‡çš„è¯·æ±‚é¡¹é˜Ÿåˆ—ç©ºæ—¶ï¼Œè¡¨æ˜æ­¤åˆ»è¯¥å—è®¾å¤‡ä¸å¿™ã€‚äºæ˜¯å†…æ ¸å°±ä¼šç«‹åˆ»å‘è¯¥å—è®¾å¤‡çš„æ§åˆ¶<br>å™¨å‘å‡ºè¯»æ•°æ®å‘½ä»¤ã€‚å½“å—è®¾å¤‡çš„æ§åˆ¶å™¨å°†æ•°æ®è¯»å…¥åˆ°æŒ‡å®šçš„ç¼“å†²å—ä¸­åï¼Œå°±ä¼šå‘å‡ºä¸­æ–­è¯·æ±‚ä¿¡å·ï¼Œå¹¶è°ƒ<br>ç”¨ç›¸åº”çš„è¯»å‘½ä»¤åå¤„ç†å‡½æ•°ï¼Œå¤„ç†ç»§ç»­è¯»æ‰‡åŒºæ“ä½œæˆ–è€…ç»“æŸæœ¬æ¬¡è¯·æ±‚é¡¹çš„è¿‡ç¨‹ã€‚ä¾‹å¦‚å¯¹ç›¸åº”å—è®¾å¤‡è¿›è¡Œ<br>å…³é—­æ“ä½œå’Œè®¾ç½®è¯¥ç¼“å†²å—æ•°æ®å·²ç»æ›´æ–°æ ‡å¿—ï¼Œæœ€å<strong>å”¤é†’</strong>ç­‰å¾…è¯¥å—æ•°æ®çš„è¿›ç¨‹ã€‚</p>
<p>å”¤é†’-&gt;åªæ˜¯å°†å¯¹åº”çš„è¿›ç¨‹çŠ¶æ€æ ‡è®°ä¸ºå¯è¿è¡Œï¼Œå¿…é¡»ç­‰åˆ°è°ƒåº¦ç¨‹åºè°ƒåº¦åæ‰ä¼šçœŸæ­£æ‰§è¡Œè¯¥è¿›ç¨‹</p>
<h3 id="Page-Cache-Buffer-Cache"><a href="#Page-Cache-Buffer-Cache" class="headerlink" title="Page Cache  Buffer Cache"></a>Page Cache  Buffer Cache</h3><p><a href="https://www.quora.com/What-is-the-major-difference-between-the-buffer-cache-and-the-page-cache-Why-were-they-separate-entities-in-older-kernels-Why-were-they-merged-later-on" target="_blank" rel="noopener">https://www.quora.com/What-is-the-major-difference-between-the-buffer-cache-and-the-page-cache-Why-were-they-separate-entities-in-older-kernels-Why-were-they-merged-later-on</a></p>
<p>Buffer Cache-&gt;disk block cache<br>Page Cache-&gt; file io cache</p>
<p>é«˜é€Ÿç¼“å†²ä¸­å­˜æ”¾ç€æœ€è¿‘è¢«ä½¿ç”¨è¿‡çš„å„ä¸ªå—è®¾å¤‡ä¸­çš„æ•°æ®å—ã€‚å½“éœ€è¦ä»å—è®¾å¤‡ä¸­è¯»å–æ•°æ®æ—¶ï¼Œç¼“å†²åŒºç®¡ç†ç¨‹åºé¦–å…ˆä¼šåœ¨é«˜é€Ÿç¼“å†²ä¸­å¯»æ‰¾ã€‚<br>å¦‚æœç›¸åº”æ•°æ®å·²ç»åœ¨ç¼“å†²ä¸­ï¼Œå°±æ— éœ€å†ä»å—è®¾å¤‡ä¸Šè¯»ã€‚å¦‚æœæ•°æ®ä¸åœ¨é«˜é€Ÿç¼“å†²ä¸­ï¼Œå°±å‘å‡ºè¯»å—è®¾å¤‡çš„å‘½<br>ä»¤ï¼Œå°†æ•°æ®è¯»åˆ°é«˜é€Ÿç¼“å†²ä¸­ã€‚å½“éœ€è¦æŠŠæ•°æ®å†™åˆ°å—è®¾å¤‡ä¸­æ—¶ï¼Œç³»ç»Ÿå°±ä¼šåœ¨é«˜é€Ÿç¼“å†²åŒºä¸­ç”³è¯·ä¸€å—ç©ºé—²çš„<br>ç¼“å†²å—æ¥ä¸´æ—¶å­˜æ”¾è¿™äº›æ•°æ®ã€‚è‡³äºä»€ä¹ˆæ—¶å€™æŠŠæ•°æ®çœŸæ­£åœ°å†™åˆ°è®¾å¤‡ä¸­å»ï¼Œåˆ™æ˜¯é€šè¿‡è®¾å¤‡æ•°æ®åŒæ­¥å®ç°çš„</p>
<h3 id="Pipe"><a href="#Pipe" class="headerlink" title="Pipe"></a>Pipe</h3><p>sys_pipe()<br>ç³»ç»Ÿè°ƒç”¨äºåˆ›å»ºæ— åç®¡é“ã€‚å®ƒé¦–å…ˆåœ¨ç³»ç»Ÿçš„æ–‡ä»¶è¡¨ä¸­å–å¾—ä¸¤ä¸ªè¡¨é¡¹ï¼Œç„¶ååœ¨å½“å‰è¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦è¡¨ä¸­ä¹ŸåŒæ ·å¯»æ‰¾ä¸¤ä¸ªæœªä½¿ç”¨çš„æè¿°ç¬¦è¡¨é¡¹ï¼Œç”¨æ¥ä¿å­˜ç›¸åº”çš„æ–‡ä»¶ç»“æ„æŒ‡é’ˆã€‚æ¥ç€åœ¨ç³»ç»Ÿä¸­ç”³iè¯·ä¸€ä¸ªç©ºèŠ‚ç‚¹ï¼ŒåŒæ—¶è·å¾—ç®¡é“ä½¿ç”¨çš„ä¸€ä¸ªç¼“å†²å—ã€‚ç„¶åå¯¹ç›¸åº”çš„æ–‡ä»¶ç»“æ„è¿›è¡Œåˆå§‹åŒ–ï¼Œå°†ä¸€ä¸ªæ–‡ä»¶ç»“æ„è®¾ç½®ä¸ºåªè¯»æ¨¡å¼ï¼Œå¦ä¸€ä¸ªè®¾ç½®ä¸ºåªå†™æ¨¡å¼ã€‚æœ€åå°†ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¼ ç»™ç”¨æˆ·ã€‚</p>
<h3 id="ä¸­æ–­æ˜¯å¦‚ä½•æ£€æµ‹çš„"><a href="#ä¸­æ–­æ˜¯å¦‚ä½•æ£€æµ‹çš„" class="headerlink" title="ä¸­æ–­æ˜¯å¦‚ä½•æ£€æµ‹çš„?"></a>ä¸­æ–­æ˜¯å¦‚ä½•æ£€æµ‹çš„?</h3><p>CPUä¼šä» APIC æˆ–è€… CPU å¼•è„šæ¥æ”¶ä¸­æ–­</p>
<p>ä»ç›®å‰äº†è§£çš„ä¿¡æ¯çœ‹</p>
<p>1ç§é€šè¿‡cpuå®šæ—¶æ£€æŸ¥ä¸­æ–­çº¿ï¼Œå¦‚æœå‘ç°æœ‰ä¸­æ–­åˆ™è¿›è¡Œå¤„ç†</p>
<p>å¦å¤–ä¸€ç§æ˜¯å¤–éƒ¨é€šè¿‡cpuçš„ä¸­æ–­å¼•è„šæ”¹å˜cpuçš„ç”µå‹äº§ç”Ÿä¸€ä¸ªä¿¡å·ä¿ƒä½¿cpuåŠæ—¶ç»ˆæ­¢å½“å‰è¿ç®—,åˆ‡æ¢ä¸­æ–­æ¨¡å—è¿›è¡Œå¤„ç†</p>
<p>æ¯ä¸€ä¸ªç‰©ç†ç¡¬ä»¶éƒ½æœ‰ä¸€æ ¹è¿æ¥ CPU çš„ä¸­æ–­çº¿ï¼Œè®¾å¤‡å¯ä»¥é€šè¿‡å®ƒå¯¹CPU å‘èµ·ä¸­æ–­ä¿¡å·ã€‚ä½†æ˜¯ä¸­æ–­ä¿¡å·å¹¶ä¸æ˜¯ç›´æ¥å‘é€ç»™ CPUã€‚åœ¨è€æœºå™¨ä¸Šä¸­æ–­ä¿¡å·å‘é€ç»™ PICï¼Œå®ƒæ˜¯ä¸€ä¸ªé¡ºåºå¤„ç†å„ç§è®¾å¤‡çš„å„ç§ä¸­æ–­è¯·æ±‚çš„èŠ¯ç‰‡ã€‚åœ¨æ–°æœºå™¨ä¸Šï¼Œåˆ™æ˜¯é«˜çº§ç¨‹åºä¸­æ–­æ§åˆ¶å™¨ï¼ˆAdvanced Programmable Interrupt Controllerï¼‰åšè¿™ä»¶äº‹æƒ…ï¼Œ</p>
<p>å¯ä»¥é€šè¿‡cat /proc/interruptsæŸ¥çœ‹ä¸­æ–­æƒ…å†µ</p>
<h2 id="ç³»ç»Ÿè°ƒåº¦"><a href="#ç³»ç»Ÿè°ƒåº¦" class="headerlink" title="ç³»ç»Ÿè°ƒåº¦"></a>ç³»ç»Ÿè°ƒåº¦</h2><p>Each processor has its own locking and individual runqueue. All runnable tasks are stored in<br>an active array and indexed according to its priority. When a process consumes its time<br>slice, it is moved to an expired array.</p>
<h3 id="å†…æ ¸å¦‚ä½•çŸ¥é“æŸä¸ªè¿›ç¨‹çš„æ—¶é—´ç‰‡ä½¿ç”¨å®Œæ¯•"><a href="#å†…æ ¸å¦‚ä½•çŸ¥é“æŸä¸ªè¿›ç¨‹çš„æ—¶é—´ç‰‡ä½¿ç”¨å®Œæ¯•" class="headerlink" title="å†…æ ¸å¦‚ä½•çŸ¥é“æŸä¸ªè¿›ç¨‹çš„æ—¶é—´ç‰‡ä½¿ç”¨å®Œæ¯•?"></a>å†…æ ¸å¦‚ä½•çŸ¥é“æŸä¸ªè¿›ç¨‹çš„æ—¶é—´ç‰‡ä½¿ç”¨å®Œæ¯•?</h3><p>ç¡¬ä»¶æä¾›æ—¶é’Ÿè§¦å‘,é€šè¿‡æ—¶é—´ä¸­æ–­ç¨‹åºæ£€æŸ¥å½“å‰æ—¶é—´ç‰‡æ˜¯å¦ä½¿ç”¨å®Œæ¯•æ˜¯å¦éœ€è¦åˆ‡æ¢ä»»åŠ¡</p>
<h2 id="å†…æ ¸å´©æºƒ"><a href="#å†…æ ¸å´©æºƒ" class="headerlink" title="å†…æ ¸å´©æºƒ"></a>å†…æ ¸å´©æºƒ</h2><p>å½“å†…æ ¸å´©æºƒæ—¶ä¼šæœ‰ä¸€ä¸ªæ•‘æ´å†…æ ¸æ¥è¿›è¡Œkdump(dumpå‡ºæ•´ä¸ªå†…å­˜çš„çŠ¶æ€ï¼Œç•™å¾…åˆ†æï¼‰</p>
<h2 id="ç”¨æˆ·ç©ºé—´-vs-å†…æ ¸ç©ºé—´"><a href="#ç”¨æˆ·ç©ºé—´-vs-å†…æ ¸ç©ºé—´" class="headerlink" title="ç”¨æˆ·ç©ºé—´ vs å†…æ ¸ç©ºé—´"></a>ç”¨æˆ·ç©ºé—´ vs å†…æ ¸ç©ºé—´</h2><h2 id="DMA"><a href="#DMA" class="headerlink" title="DMA"></a>DMA</h2><p>Direct memory access (DMA) is a feature of computer systems that allows certain hardware subsystems to access main system memory (random-access memory), independent of the central processing unit (CPU).</p>
<p>Without DMA, when the CPU is using programmed input/output, it is typically fully occupied for the entire duration of the read or write operation, and is thus unavailable to perform other work. With DMA, the CPU first initiates the transfer, then it does other operations while the transfer is in progress, and it finally receives an interrupt from the DMA controller (DMAC) when the operation is done. This feature is useful at any time that the CPU cannot keep up with the rate of data transfer, or when the CPU needs to perform work while waiting for a relatively slow I/O data transfer. Many hardware systems use DMA, including disk drive controllers, graphics cards, network cards and sound cards.</p>
<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><ol>
<li><p>å†…æ ¸æ˜¯å¦‚ä½•ä¸å¤–è®¾äº¤äº’çš„?</p>
<p>disk driver</p>
<p>éœ€è¦çœ‹äº†linuxé©±åŠ¨å¼€å‘æ‰èƒ½æœ‰ç‚¹äº†è§£â€¦</p>
<p>ç£ç›˜è‡ªèº«çš„æ§åˆ¶èŠ¯ç‰‡  ATA</p>
</li>
</ol>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>è°¢ç»æ‰“èµï¼Œå¦‚æœæ‚¨éè¦ï¼Œé‚£ä¸‹ä¸ä¸ºä¾‹å“¦ ğŸ˜„!</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>æ‰“èµ</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechat.png" alt="dumbdonkey å¾®ä¿¡æ”¯ä»˜">
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.png" alt="dumbdonkey æ”¯ä»˜å®">
        <p>æ”¯ä»˜å®</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š</strong>
    dumbdonkey
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://dumbdonkey.github.io/2019/09/10/è®¡ç®—æœºåŸºç¡€/" title="è®¡ç®—æœºåŸºç¡€">https://dumbdonkey.github.io/2019/09/10/è®¡ç®—æœºåŸºç¡€/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/è®¡ç®—æœºåŸºç¡€/" rel="tag"># è®¡ç®—æœºåŸºç¡€</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/09/09/javaä¸­ä¸€äº›åˆçœ‹ç•¥æ˜¾å¥‡æ€ªçš„åœ°æ–¹/" rel="next" title="javaä¸­ä¸€äº›åˆçœ‹ç•¥æ˜¾å¥‡æ€ªçš„åœ°æ–¹">
                <i class="fa fa-chevron-left"></i> javaä¸­ä¸€äº›åˆçœ‹ç•¥æ˜¾å¥‡æ€ªçš„åœ°æ–¹
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/09/10/linux-adv-tools/" rel="prev" title="linux_adv_tools">
                linux_adv_tools <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="dumbdonkey">
            
              <p class="site-author-name" itemprop="name">dumbdonkey</p>
              <p class="site-description motion-element" itemprop="description">ç«™åœ¨å®‡å®™çš„å°½å¤´,ç©¿è¶Šæµ©æ¸ºæ—¶ç©º,ä¿¯è§†äººç”Ÿã€å¯¹å¾…ç”Ÿå‘½!</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">44</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">24</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/dumbdonkey" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:zcauniverse@@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#å®æ¨¡å¼ä¸ä¿æŠ¤æ¨¡å¼"><span class="nav-number">1.</span> <span class="nav-text">å®æ¨¡å¼ä¸ä¿æŠ¤æ¨¡å¼</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸ºä»€ä¹ˆéœ€è¦åˆ’åˆ†å®æ¨¡å¼ä¸ä¿æŠ¤æ¨¡å¼"><span class="nav-number">1.1.</span> <span class="nav-text">ä¸ºä»€ä¹ˆéœ€è¦åˆ’åˆ†å®æ¨¡å¼ä¸ä¿æŠ¤æ¨¡å¼?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#concepts"><span class="nav-number">1.2.</span> <span class="nav-text">concepts</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è®¡ç®—æœºå¯åŠ¨è¿‡ç¨‹"><span class="nav-number">2.</span> <span class="nav-text">è®¡ç®—æœºå¯åŠ¨è¿‡ç¨‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å†…æ ¸"><span class="nav-number">3.</span> <span class="nav-text">å†…æ ¸</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å†…æ ¸ä½“ç³»"><span class="nav-number">4.</span> <span class="nav-text">å†…æ ¸ä½“ç³»</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿›ç¨‹è°ƒåº¦æ¨¡å—"><span class="nav-number">4.1.</span> <span class="nav-text">è¿›ç¨‹è°ƒåº¦æ¨¡å—</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å†…å­˜ç®¡ç†æ¨¡å—"><span class="nav-number">4.2.</span> <span class="nav-text">å†…å­˜ç®¡ç†æ¨¡å—</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ–‡ä»¶ç³»ç»Ÿæ¨¡å—"><span class="nav-number">4.3.</span> <span class="nav-text">æ–‡ä»¶ç³»ç»Ÿæ¨¡å—</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿›ç¨‹é—´é€šä¿¡æ¨¡å—"><span class="nav-number">4.4.</span> <span class="nav-text">è¿›ç¨‹é—´é€šä¿¡æ¨¡å—</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç½‘ç»œæ¥å£æ¨¡å—"><span class="nav-number">4.5.</span> <span class="nav-text">ç½‘ç»œæ¥å£æ¨¡å—</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç³»ç»Ÿå®šæ—¶"><span class="nav-number">5.</span> <span class="nav-text">ç³»ç»Ÿå®šæ—¶</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è¿›ç¨‹æ¨¡å—"><span class="nav-number">6.</span> <span class="nav-text">è¿›ç¨‹æ¨¡å—</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä»»åŠ¡çš„å †æ ˆ"><span class="nav-number">6.1.</span> <span class="nav-text">ä»»åŠ¡çš„å †æ ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CPU-load"><span class="nav-number">6.2.</span> <span class="nav-text">CPU load</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å†…å­˜æ¨¡å—"><span class="nav-number">7.</span> <span class="nav-text">å†…å­˜æ¨¡å—</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HugePage"><span class="nav-number">7.1.</span> <span class="nav-text">HugePage</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BIOS"><span class="nav-number">8.</span> <span class="nav-text">BIOS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ä¸­æ–­"><span class="nav-number">9.</span> <span class="nav-text">ä¸­æ–­</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç³»ç»Ÿè°ƒç”¨"><span class="nav-number">9.1.</span> <span class="nav-text">ç³»ç»Ÿè°ƒç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¿¡å·"><span class="nav-number">9.2.</span> <span class="nav-text">ä¿¡å·</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç¡¬ç›˜"><span class="nav-number">10.</span> <span class="nav-text">ç¡¬ç›˜</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Page-Cache-Buffer-Cache"><span class="nav-number">10.1.</span> <span class="nav-text">Page Cache  Buffer Cache</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pipe"><span class="nav-number">10.2.</span> <span class="nav-text">Pipe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸­æ–­æ˜¯å¦‚ä½•æ£€æµ‹çš„"><span class="nav-number">10.3.</span> <span class="nav-text">ä¸­æ–­æ˜¯å¦‚ä½•æ£€æµ‹çš„?</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç³»ç»Ÿè°ƒåº¦"><span class="nav-number">11.</span> <span class="nav-text">ç³»ç»Ÿè°ƒåº¦</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å†…æ ¸å¦‚ä½•çŸ¥é“æŸä¸ªè¿›ç¨‹çš„æ—¶é—´ç‰‡ä½¿ç”¨å®Œæ¯•"><span class="nav-number">11.1.</span> <span class="nav-text">å†…æ ¸å¦‚ä½•çŸ¥é“æŸä¸ªè¿›ç¨‹çš„æ—¶é—´ç‰‡ä½¿ç”¨å®Œæ¯•?</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å†…æ ¸å´©æºƒ"><span class="nav-number">12.</span> <span class="nav-text">å†…æ ¸å´©æºƒ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç”¨æˆ·ç©ºé—´-vs-å†…æ ¸ç©ºé—´"><span class="nav-number">13.</span> <span class="nav-text">ç”¨æˆ·ç©ºé—´ vs å†…æ ¸ç©ºé—´</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DMA"><span class="nav-number">14.</span> <span class="nav-text">DMA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é—®é¢˜"><span class="nav-number">15.</span> <span class="nav-text">é—®é¢˜</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">dumbdonkey</span>

  

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.0.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.0.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.0"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: '4tFueWqAqISWdoJCSRebdTfP-gzGzoHsz',
        appKey: '5wbeKcDdrMfbmbRWr45sTlsp',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
